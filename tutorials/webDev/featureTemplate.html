<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>HackerPack</title>

    <link rel="stylesheet"
          href="../../bower_components/bootstrap/dist/css/bootstrap.css">
    <link rel="stylesheet"
          href="../../bower_components/bootstrap/dist/css/bootstrap-theme.css">
    <link rel="stylesheet" href="../../assets/css/featureTemplate.css">
    <link rel="stylesheet" href="../../assets/css/prism.css">

</head>
<body>

<!-- Navigation bar -->
<nav class="navbar navbar-default navbar-fixed-top">
    <div class="container-fluid">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse"
                    data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>

            <a href="../../index.html" class="navbar-brand">
                <span class="hred">Hacker</span>
                <span class="hgreen">Pack</span>
            </a>

        </div>

        <div class="navbar-collapse collapse">
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="../../about.html">About</a>
                </li>
                <li>
                    <a href="../../onboarding.html">How It Works</a>
                </li>
                <li>
                    <a href="../index.html">Tutorials</a>
                </li>
                <li>
                    <a href="../../profile.html">My Profile</a>
                </li>
            </ul>
        </div>
    </div>
</nav>

<!-- Main content -->
<div class="codeblock">
    <h1 id="title"> HTML Template </h1>
    <div class="col-sm-6" id = "all-code">
    <pre>
    <code class="language-markup" id="code-panel">
        <!-- <code id="code-panel">
        </code> -->
    </code>
    </pre>
    </div>
</div>

<script src="../../bower_components/jquery/dist/jquery.js"></script>
<script src="../../bower_components/bootstrap/dist/js/bootstrap.js"></script>

<script src="../../assets/js/prism.js"></script>

<script>

    var GetURLParameter = function (sParam) {
        var sPageURL = window.location.search.substring(1);
        var sURLVariables = sPageURL.split('&');
        for (var i = 0; i < sURLVariables.length; i++) {
            var sParameterName = sURLVariables[i].split('=');
            if (sParameterName[0] == sParam) {
                return sParameterName[1];
            }
        }
    };

    var feature_name = GetURLParameter('name');

    var feature_url = "./dummyBackend/features/" + feature_name + ".json";

    var code_panel = document.getElementById('code-panel');

    var tutorial_panels = {};

    var number_of_code = {};

    $.getJSON(feature_url, function (data) {

        document.getElementById('title').innerText = data["feature_name"];

        var feature_descriptions = data["feature_descriptions"];
        number_of_code = data["number_of_code"];
        var number_of_desc = data["number_of_desc"];
        tutorial_panels = data["tutorial_panels"];



        for (var i = 0; i < number_of_code; i++) {
            var code = "<pre>" + tutorial_panels[i]["code_" + String(i)] + "</pre>";
            console.log(code);
//            var desc = tutorial_panels[i]["desc_" + String(i)];
            var newFeature = document.createElement('div');
            newFeature.setAttribute("id", i);
            newFeature.setAttribute("onclick", "highlightCode(this.id)");
            newFeature.innerHTML =  code ;
            code_panel.appendChild(newFeature);
            Prism.highlightElement(newFeature);
        }
    });


    var highlightCode = function(idNumber) {
        console.log(idNumber);

        lines = tutorial_panels[idNumber]["line_" + String(idNumber)];
        console.log(lines);

        var all_code = document.getElementById("all-code");
        $('#all-code').empty();

        var codeblock = document.createElement('pre');
        codeblock.setAttribute("data-line", lines);
        codeblock.setAttribute("id", "code-panel");
        codeblock.className = 'language-markup';
        all_code.appendChild(codeblock);

        //var codeP = document.createElement('code');
        // codeP.className = "language-markup";

        for (var i = 0; i < number_of_code; i++) {
            var code = "<pre>" + tutorial_panels[i]["code_" + String(i)] + "</pre>";
            var newFeature = document.createElement('div');
            newFeature.setAttribute("id", i);
            newFeature.setAttribute("onclick", "highlightCode(this.id)");
            newFeature.innerHTML = "<code>" + code + "</code>";
            //codeP.appendChild(newFeature); 
            codeblock.appendChild(newFeature);
            Prism.highlightElement(newFeature);  
        } 

        //Prism.highlightAll();
    };


</script>


</body>
</html>